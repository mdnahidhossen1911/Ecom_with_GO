# ğŸ›’ Ecom_with_GO - à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦Ÿà§‡à¦•à¦¨à¦¿à¦•à§à¦¯à¦¾à¦² à¦¡à¦•à§à¦®à§‡à¦¨à§à¦Ÿà§‡à¦¶à¦¨

## ğŸ“‹ à¦¸à§‚à¦šà¦¿à¦ªà¦¤à§à¦°
1. [à¦ªà§à¦°à¦œà§‡à¦•à§à¦Ÿ à¦“à¦­à¦¾à¦°à¦­à¦¿à¦‰](#à¦ªà§à¦°à¦œà§‡à¦•à§à¦Ÿ-à¦“à¦­à¦¾à¦°à¦­à¦¿à¦‰)
2. [à¦†à¦°à§à¦•à¦¿à¦Ÿà§‡à¦•à¦šà¦¾à¦° à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£](#à¦†à¦°à§à¦•à¦¿à¦Ÿà§‡à¦•à¦šà¦¾à¦°-à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£)
3. [à¦¡à¦¿à¦°à§‡à¦•à§à¦Ÿà¦°à¦¿ à¦¸à§à¦Ÿà§à¦°à¦¾à¦•à¦šà¦¾à¦°](#à¦¡à¦¿à¦°à§‡à¦•à§à¦Ÿà¦°à¦¿-à¦¸à§à¦Ÿà§à¦°à¦¾à¦•à¦šà¦¾à¦°)
4. [à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¸à§à¦•à¦¿à¦®à¦¾](#à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸-à¦¸à§à¦•à¦¿à¦®à¦¾)
5. [API à¦à¦¨à§à¦¡à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿà¦¸](#api-à¦à¦¨à§à¦¡à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿà¦¸)
6. [à¦«à¦¾à¦‡à¦² à¦¬à¦¾à¦‡ à¦«à¦¾à¦‡à¦² à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤ à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£](#à¦«à¦¾à¦‡à¦²-à¦¬à¦¾à¦‡-à¦«à¦¾à¦‡à¦²-à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤-à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£)
7. [à¦¸à¦¿à¦•à¦¿à¦‰à¦°à¦¿à¦Ÿà¦¿ à¦«à¦¿à¦šà¦¾à¦°à§à¦¸](#à¦¸à¦¿à¦•à¦¿à¦‰à¦°à¦¿à¦Ÿà¦¿-à¦«à¦¿à¦šà¦¾à¦°à§à¦¸)
8. [à¦®à¦¿à¦¡à¦²à¦“à¦¯à¦¼à§à¦¯à¦¾à¦° à¦¸à¦¿à¦¸à§à¦Ÿà§‡à¦®](#à¦®à¦¿à¦¡à¦²à¦“à¦¯à¦¼à§à¦¯à¦¾à¦°-à¦¸à¦¿à¦¸à§à¦Ÿà§‡à¦®)
9. [à¦¡à§‡à¦Ÿà¦¾ à¦«à§à¦²à§‹](#à¦¡à§‡à¦Ÿà¦¾-à¦«à§à¦²à§‹)
10. [à¦¡à¦¿à¦ªà§‡à¦¨à§à¦¡à§‡à¦¨à§à¦¸à¦¿ à¦®à§à¦¯à¦¾à¦¨à§‡à¦œà¦®à§‡à¦¨à§à¦Ÿ](#à¦¡à¦¿à¦ªà§‡à¦¨à§à¦¡à§‡à¦¨à§à¦¸à¦¿-à¦®à§à¦¯à¦¾à¦¨à§‡à¦œà¦®à§‡à¦¨à§à¦Ÿ)

---

## ğŸ¯ à¦ªà§à¦°à¦œà§‡à¦•à§à¦Ÿ à¦“à¦­à¦¾à¦°à¦­à¦¿à¦‰

### à¦ªà§à¦°à¦œà§‡à¦•à§à¦Ÿ à¦¬à¦¿à¦¬à¦°à¦£
**à¦¨à¦¾à¦®:** Ecom_with_GO  
**à¦­à¦¾à¦·à¦¾:** Go (Golang)  
**à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸:** PostgreSQL  
**à¦†à¦°à§à¦•à¦¿à¦Ÿà§‡à¦•à¦šà¦¾à¦°:** Clean Architecture / Hexagonal Architecture  
**API à¦Ÿà¦¾à¦‡à¦ª:** RESTful API  
**Authentication:** JWT (JSON Web Token)  

### à¦Ÿà§‡à¦•à¦¨à§‹à¦²à¦œà¦¿ à¦¸à§à¦Ÿà§à¦¯à¦¾à¦•

| Category | Technology | Purpose |
|----------|-----------|---------|
| Backend Language | Go 1.x | Main programming language |
| Web Framework | net/http (Standard Library) | HTTP server & routing |
| Database | PostgreSQL | Data persistence |
| ORM/Query Builder | sqlx | Database operations |
| Migration Tool | sql-migrate | Database schema management |
| Environment Config | godotenv | Environment variable management |
| Password Hashing | crypto/md5 | Password security (âš ï¸ deprecated) |
| JWT | Custom Implementation | Authentication |

### à¦ªà§à¦°à¦œà§‡à¦•à§à¦Ÿ à¦«à¦¿à¦šà¦¾à¦°à§à¦¸

âœ… **User Management**
- User Registration
- User Login with JWT
- Password Hashing
- User CRUD Operations (partial)

âœ… **Product Management**
- Create Product (authenticated)
- List Products with Pagination
- Get Single Product
- Update Product (authenticated)
- Delete Product (authenticated)
- Product Count

âœ… **Security Features**
- JWT Authentication
- Rate Limiting (6 req/sec per IP)
- IP Blocking (5 min on abuse)
- CORS Support
- Password Hashing

âœ… **Advanced Features**
- Database Migration System
- Middleware Chain Management
- Concurrent Data Fetching (Goroutines)
- Request Logging
- Pagination Support
- Error Handling

---

## ğŸ—ï¸ à¦†à¦°à§à¦•à¦¿à¦Ÿà§‡à¦•à¦šà¦¾à¦° à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£

### Clean Architecture Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRESENTATION LAYER                        â”‚
â”‚  (rest/handlers/*, rest/middleware/*, rest/server.go)       â”‚
â”‚  - HTTP Request/Response Handling                           â”‚
â”‚  - JSON Serialization/Deserialization                       â”‚
â”‚  - Middleware Execution                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BUSINESS LOGIC LAYER                      â”‚
â”‚              (user/*, product/*)                            â”‚
â”‚  - Business Rules & Validation                              â”‚
â”‚  - Domain Logic                                             â”‚
â”‚  - Service Interfaces                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA ACCESS LAYER                         â”‚
â”‚                     (repo/*)                                â”‚
â”‚  - Database Operations (CRUD)                               â”‚
â”‚  - SQL Query Execution                                      â”‚
â”‚  - Data Mapping                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INFRASTRUCTURE LAYER                      â”‚
â”‚              (infra/db/*, config/*)                         â”‚
â”‚  - Database Connection                                      â”‚
â”‚  - Configuration Management                                 â”‚
â”‚  - External Dependencies                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dependency Flow (Dependency Inversion Principle)

```
main.go
  â””â”€> cmd/serve.go (Dependency Injection Hub)
        â”œâ”€> config.GetConfig()
        â”œâ”€> db.NewDBConnection()
        â”œâ”€> db.MigrateDB()
        â”œâ”€> repo.NewUserRepo(dbCon)
        â”œâ”€> repo.NewProductRepo(dbCon)
        â”œâ”€> user.NewService(userRepo)
        â”œâ”€> product.NewService(productRepo)
        â”œâ”€> userHandler.NewHandler(config, usrService)
        â”œâ”€> productHandler.NewHandler(middleware, prdService)
        â””â”€> rest.NewServer(config, handlers...)
              â””â”€> server.Start() â†’ HTTP Listen :8000
```

### Request Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚ HTTP Request
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Middleware Chain                â”‚
â”‚  1. CORS                                â”‚
â”‚  2. Preflight                           â”‚
â”‚  3. Logger                              â”‚
â”‚  4. RateLimit                           â”‚
â”‚  5. AuthenticateJWT (conditional)       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         HTTP Handler                    â”‚
â”‚  - Parse Request                        â”‚
â”‚  - Validate Input                       â”‚
â”‚  - Call Service Layer                   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Service Layer                   â”‚
â”‚  - Business Logic                       â”‚
â”‚  - Call Repository                      â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Repository Layer                â”‚
â”‚  - SQL Query Execution                  â”‚
â”‚  - Database Operations                  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PostgreSQL Database             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ Return Data
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         JSON Response                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ à¦¡à¦¿à¦°à§‡à¦•à§à¦Ÿà¦°à¦¿ à¦¸à§à¦Ÿà§à¦°à¦¾à¦•à¦šà¦¾à¦°

```
Ecom_with_GO/
â”‚
â”œâ”€â”€ .env                          # Environment variables
â”œâ”€â”€ .idea/                        # IDE configuration (IntelliJ/GoLand)
â”œâ”€â”€ .vscode/                      # VS Code configuration
â”œâ”€â”€ main.go                       # Application entry point
â”œâ”€â”€ go.mod                        # Go module dependencies
â”œâ”€â”€ go.sum                        # Dependency checksums
â”‚
â”œâ”€â”€ cmd/                          # Command layer
â”‚   â””â”€â”€ serve.go                  # Server initialization & DI
â”‚
â”œâ”€â”€ config/                       # Configuration management
â”‚   â”œâ”€â”€ config.go                 # Main config loader
â”‚   â””â”€â”€ db_config.go              # Database config loader
â”‚
â”œâ”€â”€ db_quarys/                    # Database query examples
â”‚   â””â”€â”€ create_users_table.sql    # SQL example
â”‚
â”œâ”€â”€ domain/                       # Domain models (Entities)
â”‚   â”œâ”€â”€ user.go                   # User entity
â”‚   â””â”€â”€ product.go                # Product entity
â”‚
â”œâ”€â”€ infra/                        # Infrastructure layer
â”‚   â””â”€â”€ db/
â”‚       â”œâ”€â”€ connection.go         # DB connection setup
â”‚       â””â”€â”€ migrate.go            # DB migration runner
â”‚
â”œâ”€â”€ migrations/                   # Database migrations
â”‚   â”œâ”€â”€ 000001-create-users.up.sql
â”‚   â”œâ”€â”€ 000001-create-users.down.sql
â”‚   â”œâ”€â”€ 000002-create-products.up.sql
â”‚   â””â”€â”€ 000002-create-products.down.sql
â”‚
â”œâ”€â”€ user/                         # User service layer
â”‚   â”œâ”€â”€ port.go                   # Service interface
â”‚   â”œâ”€â”€ service.go                # Service implementation
â”‚   â”œâ”€â”€ create.go                 # Create user logic
â”‚   â”œâ”€â”€ find.go                   # Find user logic
â”‚   â”œâ”€ï¿½ï¿½ï¿½ get.go                    # Get user logic (unimplemented)
â”‚   â”œâ”€â”€ list.go                   # List users (unimplemented)
â”‚   â”œâ”€â”€ update.go                 # Update user (unimplemented)
â”‚   â””â”€â”€ delete.go                 # Delete user (unimplemented)
â”‚
â”œâ”€â”€ product/                      # Product service layer
â”‚   â”œâ”€â”€ port.go                   # Service interface
â”‚   â””â”€â”€ service.go                # Service implementation (all methods)
â”‚
â”œâ”€â”€ repo/                         # Repository layer (Data Access)
â”‚   â”œâ”€â”€ users.go                  # User repository
â”‚   â””â”€â”€ product.go                # Product repository
â”‚
â”œâ”€â”€ rest/                         # REST API layer
â”‚   â”œâ”€â”€ server.go                 # HTTP server setup
â”‚   â”‚
â”‚   â”œâ”€â”€ handlers/                 # HTTP handlers
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”œâ”€â”€ handler.go        # User handler struct
â”‚   â”‚   â”‚   â”œâ”€â”€ port.go           # Handler service interface
â”‚   â”‚   â”‚   â”œâ”€â”€ create_user.go    # POST /users
â”‚   â”‚   â”‚   â”œâ”€â”€ login.go          # POST /users/login
â”‚   â”‚   â”‚   â””â”€â”€ router.go         # User routes registration
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ product/
â”‚   â”‚       â”œâ”€â”€ handler.go        # Product handler struct
â”‚   â”‚       â”œâ”€â”€ port.go           # Handler service interface
â”‚   â”‚       â”œâ”€â”€ create_product.go # POST /products
ï¿½ï¿½ï¿½   â”‚       â”œâ”€â”€ get_products.go   # GET /products
â”‚   â”‚       â”œâ”€â”€ get_product_by_id.go # GET /products/{id}
â”‚   â”‚       â”œâ”€â”€ update_product.go # PUT /products/{id}
â”‚   â”‚       â”œâ”€â”€ delete_product.go # DELETE /products/{id}
â”‚   â”‚       â””â”€â”€ router.go         # Product routes registration
â”‚   â”‚
â”‚   â””â”€â”€ middleware/               # Middleware components
â”‚       â”œâ”€â”€ manager.go            # Middleware chain manager
â”‚       â”œâ”€â”€ config_middleware.go  # Config-aware middleware
â”‚       â”œâ”€â”€ cors.go               # CORS headers
â”‚       â”œâ”€â”€ preflight.go          # OPTIONS request handler
â”‚       â”œâ”€â”€ logger.go             # Request logging
â”‚       â”œâ”€â”€ rate_limit.go         # Rate limiting & IP blocking
â”‚       â””â”€â”€ authenticate_jwt.go   # JWT authentication
â”‚
â””â”€â”€ util/                         # Utility functions
    â”œâ”€â”€ create_jwt.go             # JWT token generator
    â”œâ”€â”€ secPass.go                # Password hashing (MD5)
    â”œâ”€â”€ sent_json_response.go     # JSON response helpers
    â””â”€â”€ send_page.go              # Pagination response helper
```

---

## ğŸ—„ï¸ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¸à§à¦•à¦¿à¦®à¦¾

### Users Table

```sql
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    name VARCHAR(150) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password TEXT NOT NULL,
    is_owner BOOLEAN NOT NULL DEFAULT FALSE,
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);
```

**à¦«à¦¿à¦²à§à¦¡ à¦¬à¦¿à¦¬à¦°à¦£:**
- `id`: UUID à¦ªà§à¦°à¦¾à¦‡à¦®à¦¾à¦°à¦¿ à¦•à§€ (auto-generated)
- `name`: à¦‡à¦‰à¦œà¦¾à¦°à§‡à¦° à¦¨à¦¾à¦® (à¦¸à¦°à§à¦¬à§‹à¦šà§à¦š 150 à¦…à¦•à§à¦·à¦°)
- `email`: à¦‡à¦‰à¦œà¦¾à¦° à¦‡à¦®à§‡à¦‡à¦² (unique constraint)
- `password`: à¦¹à§à¦¯à¦¾à¦¶à¦•à§ƒà¦¤ à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ (MD5)
- `is_owner`: à¦®à¦¾à¦²à¦¿à¦• à¦•à¦¿à¦¨à¦¾ (boolean, default: false)
- `created_at`: à¦à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¤à§ˆà¦°à¦¿à¦° à¦¸à¦®à¦¯à¦¼
- `updated_at`: à¦¶à§‡à¦· à¦†à¦ªà¦¡à§‡à¦Ÿà§‡à¦° à¦¸à¦®à¦¯à¦¼

### Products Table

```sql
CREATE TABLE products (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    title VARCHAR(255) NOT NULL,
    description TEXT,
    price NUMERIC(10, 2) NOT NULL DEFAULT 0,
    image_url TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**à¦«à¦¿à¦²à§à¦¡ à¦¬à¦¿à¦¬à¦°à¦£:**
- `id`: UUID à¦ªà§à¦°à¦¾à¦‡à¦®à¦¾à¦°à¦¿ à¦•à§€ (auto-generated)
- `title`: à¦ªà¦£à§à¦¯à§‡à¦° à¦¶à¦¿à¦°à§‹à¦¨à¦¾à¦® (à¦¸à¦°à§à¦¬à§‹à¦šà§à¦š 255 à¦…à¦•à§à¦·à¦°)
- `description`: à¦ªà¦£à§à¦¯à§‡à¦° à¦¬à¦¿à¦¬à¦°à¦£ (unlimited text)
- `price`: à¦ªà¦£à§à¦¯à§‡à¦° à¦®à§‚à¦²à§à¦¯ (10 à¦¡à¦¿à¦œà¦¿à¦Ÿ, 2 à¦¦à¦¶à¦®à¦¿à¦•)
- `image_url`: à¦ªà¦£à§à¦¯à§‡à¦° à¦›à¦¬à¦¿à¦° URL
- `created_at`: à¦ªà¦£à§à¦¯ à¦¯à§à¦•à§à¦¤ à¦•à¦°à¦¾à¦° à¦¸à¦®à¦¯à¦¼
- `updated_at`: à¦¶à§‡à¦· à¦†à¦ªà¦¡à§‡à¦Ÿà§‡à¦° à¦¸à¦®à¦¯à¦¼

### ER Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           USERS                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ id (UUID, PK)                 â”‚
â”‚ â€¢ name (VARCHAR)                â”‚
â”‚ â€¢ email (VARCHAR, UNIQUE)       â”‚
â”‚ â€¢ password (TEXT)               â”‚
â”‚ â€¢ is_owner (BOOLEAN)            â”‚
â”‚ â€¢ created_at (TIMESTAMPTZ)      â”‚
â”‚ â€¢ updated_at (TIMESTAMPTZ)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ (Future: orders relationship)
         â”‚
         ï¿½ï¿½ï¿½
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PRODUCTS                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ id (UUID, PK)                 â”‚
â”‚ â€¢ title (VARCHAR)               â”‚
â”‚ â€¢ description (TEXT)            â”‚
â”‚ â€¢ price (NUMERIC)               â”‚
â”‚ â€¢ image_url (TEXT)              â”‚
â”‚ â€¢ created_at (TIMESTAMPTZ)      â”‚
â”‚ â€¢ updated_at (TIMESTAMPTZ)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ API à¦à¦¨à§à¦¡à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿà¦¸

### Base URL
```
http://localhost:8000
```

### Authentication
JWT token à¦ªà§à¦°à¦¯à¦¼à§‹à¦œà¦¨ à¦à¦®à¦¨ endpoints à¦à¦° à¦œà¦¨à§à¦¯:
```
Authorization: Bearer <JWT_TOKEN>
```

---

### ğŸ‘¤ User Endpoints

#### 1. Create User (Registration)
**Endpoint:** `POST /users`  
**Authentication:** âŒ Not Required  
**Description:** à¦¨à¦¤à§à¦¨ à¦‡à¦‰à¦œà¦¾à¦° à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨

**Request Body:**
```json
{
    "name": "John Doe",
    "email": "john@example.com",
    "password": "mypassword123",
    "is_owner": false
}
```

**Response (200):**
```json
{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "John Doe",
    "email": "john@example.com",
    "is_owner": false,
    "created_at": "2026-02-10T10:30:00Z",
    "updated_at": "2026-02-10T10:30:00Z"
}
```

**Password Hashing:**
- Password à¦Ÿà¦¿ MD5 hash à¦•à¦°à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡ à¦¸à¦‚à¦°à¦•à§à¦·à¦¿à¦¤ à¦¹à¦¯à¦¼
- Original password à¦•à¦–à¦¨à§‹ à¦¸à¦‚à¦°à¦•à§à¦·à¦¿à¦¤ à¦¹à¦¯à¦¼ à¦¨à¦¾

---

#### 2. User Login
**Endpoint:** `POST /users/login`  
**Authentication:** âŒ Not Required  
**Description:** à¦‡à¦‰à¦œà¦¾à¦° à¦²à¦—à¦‡à¦¨ à¦à¦¬à¦‚ JWT token à¦ªà§à¦°à¦¾à¦ªà§à¦¤à¦¿

**Request Body:**
```json
{
    "email": "john@example.com",
    "password": "mypassword123"
}
```

**Response (200):**
```json
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1NTBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDAiLCJuYW1lIjoiSm9obiBEb2UiLCJlbWFpbCI6ImpvaG5AZXhhbXBsZS5jb20iLCJpc19vd25lciI6ZmFsc2UsImNyZWF0ZWRfYXQiOiIyMDI2LTAyLTEwVDEwOjMwOjAwWiIsInVwZGF0ZWRfYXQiOiIyMDI2LTAyLTEwVDEwOjMwOjAwWiJ9.signature"
```

**JWT Token Structure:**
```
Header.Payload.Signature
```

**Payload Contents:**
```json
{
    "sub": "user_id",
    "name": "user_name",
    "email": "user_email",
    "is_owner": true/false,
    "created_at": "timestamp",
    "updated_at": "timestamp"
}
```

**Error Response (404):**
```json
"Invalid Credential: user not found"
```

---

### ğŸ“¦ Product Endpoints

#### 1. List Products (with Pagination)
**Endpoint:** `GET /products?page=1&limit=10`  
**Authentication:** âŒ Not Required  
**Description:** à¦ªà¦£à§à¦¯ à¦¤à¦¾à¦²à¦¿à¦•à¦¾ pagination à¦¸à¦¹

**Query Parameters:**
- `page` (optional): à¦ªà§ƒï¿½ï¿½à§à¦ à¦¾ à¦¨à¦®à§à¦¬à¦° (default: 1)
- `limit` (optional): à¦ªà§ƒà¦·à§à¦ à¦¾ à¦ªà§à¦°à¦¤à¦¿ à¦†à¦‡à¦Ÿà§‡à¦® (default: 10)

**Response (200):**
```json
{
    "data": [
        {
            "id": "660e8400-e29b-41d4-a716-446655440000",
            "title": "iPhone 15 Pro",
            "description": "Latest Apple smartphone",
            "price": 999.99,
            "image_url": "https://example.com/iphone15.jpg",
            "created_at": "2026-02-01T10:00:00Z",
            "updated_at": "2026-02-01T10:00:00Z"
        },
        {
            "id": "770e8400-e29b-41d4-a716-446655440001",
            "title": "MacBook Pro M3",
            "description": "Powerful laptop",
            "price": 2499.99,
            "image_url": "https://example.com/macbook.jpg",
            "created_at": "2026-02-02T11:00:00Z",
            "updated_at": "2026-02-02T11:00:00Z"
        }
    ],
    "pagination": {
        "page": 1,
        "limit": 10,
        "total_item": 25,
        "total_page": 3
    }
}
```

**Implementation Note:**
- Concurrent data fetching using Goroutines
- Two goroutines run parallel:
  1. Fetch product list
  2. Fetch total count
- Results merged via channels

---

#### 2. Get Single Product
**Endpoint:** `GET /products/{productID}`  
**Authentication:** âŒ Not Required  
**Description:** à¦¨à¦¿à¦°à§à¦¦à¦¿à¦·à§à¦Ÿ à¦ªà¦£à§à¦¯à§‡à¦° à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤ à¦¤à¦¥à§à¦¯

**Response (200):**
```json
{
    "id": "660e8400-e29b-41d4-a716-446655440000",
    "title": "iPhone 15 Pro",
    "description": "Latest Apple smartphone with A17 Pro chip",
    "price": 999.99,
    "image_url": "https://example.com/iphone15.jpg",
    "created_at": "2026-02-01T10:00:00Z",
    "updated_at": "2026-02-01T10:00:00Z"
}
```

**Error Response (404):**
```json
"Product not found"
```

---

#### 3. Create Product
**Endpoint:** `POST /products`  
**Authentication:** âœ… JWT Required  
**Description:** à¦¨à¦¤à§à¦¨ à¦ªà¦£à§à¦¯ à¦¯à§à¦•à§à¦¤ à¦•à¦°à¦¾

**Request Headers:**
```
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

**Request Body:**
```json
{
    "title": "Samsung Galaxy S24",
    "description": "Latest Android flagship",
    "price": 899.99,
    "image_url": "https://example.com/galaxy-s24.jpg"
}
```

**Response (201):**
```json
{
    "id": "880e8400-e29b-41d4-a716-446655440002",
    "title": "Samsung Galaxy S24",
    "description": "Latest Android flagship",
    "price": 899.99,
    "image_url": "https://example.com/galaxy-s24.jpg",
    "created_at": "2026-02-10T12:00:00Z",
    "updated_at": "2026-02-10T12:00:00Z"
}
```

**Error Response (401):**
```json
"Unauthorized"
```

---

#### 4. Update Product
**Endpoint:** `PUT /products/{productID}`  
**Authentication:** âœ… JWT Required  
**Description:** à¦¬à¦¿à¦¦à§à¦¯à¦®à¦¾à¦¨ à¦ªà¦£à§à¦¯ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¾

**Request Headers:**
```
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

**Request Body:**
```json
{
    "title": "iPhone 15 Pro Max",
    "description": "Updated description",
    "price": 1099.99,
    "image_url": "https://example.com/iphone15-pro-max.jpg"
}
```

**Response (201):**
```json
{
    "id": "660e8400-e29b-41d4-a716-446655440000",
    "title": "iPhone 15 Pro Max",
    "description": "Updated description",
    "price": 1099.99,
    "image_url": "https://example.com/iphone15-pro-max.jpg",
    "created_at": "2026-02-01T10:00:00Z",
    "updated_at": "2026-02-10T13:00:00Z"
}
```

**Error Responses:**
- `400`: Bad Request (invalid JSON)
- `401`: Unauthorized (missing/invalid JWT)
- `404`: Product not found
- `500`: Internal server error

---

#### 5. Delete Product
**Endpoint:** `DELETE /products/{productID}`  
**Authentication:** âœ… JWT Required  
**Description:** à¦ªà¦£à§à¦¯ à¦®à§à¦›à§‡ à¦«à§‡à¦²à¦¾

**Request Headers:**
```
Authorization: Bearer <JWT_TOKEN>
```

**Response (200):**
```json
"Product deleted successfully"
```

**Error Responses:**
- `400`: Product ID required
- `401`: Unauthorized
- `404`: Product not found

---

### Error Response Format

à¦¸à¦¬ endpoints à¦à¦•à¦‡ error format à¦…à¦¨à§à¦¸à¦°à¦£ à¦•à¦°à§‡:

**Client Error (4xx):**
```json
"Error message describing the problem"
```

**Server Error (5xx):**
```json
"Internal server error message"
```

---

### Rate Limiting

**Rules:**
- Maximum 6 requests per second per IP
- Exceeded requests â†’ 429 Too Many Requests
- IP blocked for 5 minutes on abuse

**Rate Limit Response (429):**
```json
"Too many requests! IP blocked for 5 minutes."
```

---

## ğŸ“„ à¦«à¦¾à¦‡à¦² à¦¬à¦¾à¦‡ à¦«à¦¾à¦‡à¦² à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤ à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£

### ğŸ”¹ Root Level Files

#### main.go
```go
package main

import "ecom_project/cmd"

func main() {
	cmd.Serve()
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**
- **à¦‰à¦¦à§à¦¦à§‡à¦¶à§à¦¯:** Application à¦à¦° entry point
- **à¦•à¦¾à¦œ:** à¦¶à§à¦§à§à¦®à¦¾à¦¤à§à¦° `cmd.Serve()` function à¦•à¦² à¦•à¦°à§‡
- **à¦¡à¦¿à¦œà¦¾à¦‡à¦¨ à¦ªà§à¦¯à¦¾à¦Ÿà¦¾à¦°à§à¦¨:** Separation of concerns - main à¦¥à§‡à¦•à§‡ initialization logic à¦†à¦²à¦¾à¦¦à¦¾
- **Execution Flow:** 
  1. Program à¦¶à§à¦°à§ à¦¹à¦¯à¦¼ main() à¦¥à§‡à¦•à§‡
  2. cmd.Serve() à¦•à¦² à¦¹à¦¯à¦¼
  3. Serve() à¦¸à¦¬ initialization à¦•à¦°à§‡ server à¦šà¦¾à¦²à§ à¦•à¦°à§‡

---

#### .env
```env
VERSION=1.0.0
SERVICE_NAME=ecom_project
PORT=8000
JWT_SECURE_KEY=Mdn@hid1911

DB_HOST=127.0.0.1
DB_PORT=5432    
DB_USER=postgres
DB_PASSWORD=2003
DB_NAME=ecom
DB_SSLMODE=disable
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**
- **à¦‰à¦¦à§à¦¦à§‡à¦¶à§à¦¯:** Environment-specific configuration à¦¸à¦‚à¦°à¦•à§à¦·à¦£
- **Security Note:** Production à¦ à¦à¦‡ à¦«à¦¾à¦‡à¦² .gitignore à¦ à¦¥à¦¾à¦•à¦¾ à¦‰à¦šà¦¿à¦¤
- **Configuration Categories:**
  - **Application Config:** VERSION, SERVICE_NAME, PORT
  - **Security Config:** JWT_SECURE_KEY
  - **Database Config:** All DB_* variables

**Best Practices:**
- Different .env files for dev/staging/production
- Never commit sensitive credentials to git
- Use environment variable managers (e.g., AWS Secrets Manager) in production

---

### ğŸ”¹ cmd/serve.go

```go
package cmd

import (
	"ecom_project/config"
	"ecom_project/infra/db"
	"ecom_project/product"
	"ecom_project/repo"
	"ecom_project/rest"
	productHandler "ecom_project/rest/handlers/product"
	userHandler "ecom_project/rest/handlers/user"
	"ecom_project/rest/middleware"
	"ecom_project/user"
	"fmt"
	"os"
)

func Serve() {
	// 1. Load Configuration
	config := config.GetConfig()

	// 2. Database Connection
	dbCon, err := db.NewDBConnection(config.DBConfig)
	if err != nil {
		fmt.Println("Failed to connect to the database:", err)
		os.Exit(1)
		return
	}

	// 3. Database Migration
	error := db.MigrateDB(dbCon, "./migrations")
	if error != nil {
		fmt.Println("Failed to migrate the database:", error)
		os.Exit(1)
		return
	}

	// 4. Repository Layer Initialization
	userRepo := repo.NewUserRepo(dbCon)
	productRepo := repo.NewProductRepo(dbCon)

	// 5. Service Layer Initialization
	usrService := user.NewService(userRepo)
	prdService := product.NewService(productRepo)
	middleware := middleware.NewConfigMiddleware(config)

	// 6. Handler Layer Initialization
	productsHandler := productHandler.NewHandler(middleware, prdService)
	userHandler := userHandler.NewHandler(config, usrService)

	// 7. HTTP Server Initialization & Start
	server := rest.NewServer(config, productsHandler, userHandler)
	server.Start()
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**1. Configuration Loading**
```go
config := config.GetConfig()
```
- Singleton pattern à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ config load
- First call à¦ .env à¦¥à§‡à¦•à§‡ à¦ªà¦¡à¦¼à§‡
- Subsequent calls à¦à¦•à¦‡ instance return à¦•à¦°à§‡
- Validation à¦¸à¦¹ load (missing values = os.Exit(1))

**2. Database Connection**
```go
dbCon, err := db.NewDBConnection(config.DBConfig)
```
- PostgreSQL à¦ connection establish à¦•à¦°à§‡
- Connection string à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§‡ config à¦¥à§‡à¦•à§‡
- sqlx.DB instance return à¦•à¦°à§‡
- Connection failure = graceful shutdown

**3. Database Migration**
```go
error := db.MigrateDB(dbCon, "./migrations")
```
- migrations/ folder à¦à¦° SQL files execute à¦•à¦°à§‡
- Up migrations run à¦•à¦°à§‡ (table creation/updates)
- Version tracking for idempotency
- Migration failure = application exit

**4. Dependency Injection - Repository Layer**
```go
userRepo := repo.NewUserRepo(dbCon)
productRepo := repo.NewProductRepo(dbCon)
```
- Database connection inject à¦•à¦°à¦¾ à¦¹à¦¯à¦¼ repositories à¦¤à§‡
- Each repository gets its own instance
- Follows Repository Pattern

**5. Dependency Injection - Service Layer**
```go
usrService := user.NewService(userRepo)
prdService := product.NewService(productRepo)
```
- Repository instances inject à¦•à¦°à¦¾ à¦¹à¦¯à¦¼ services à¦
- Business logic layer à¦¤à§ˆà¦°à¦¿
- Decoupled from data access details

**6. Dependency Injection - Handler Layer**
```go
productsHandler := productHandler.NewHandler(middleware, prdService)
userHandler := userHandler.NewHandler(config, usrService)
```
- Service instances inject à¦•à¦°à¦¾ à¦¹à¦¯à¦¼ handlers à¦
- HTTP request handling layer à¦¤à§ˆà¦°à¦¿
- Middleware configuration included

**7. Server Start**
```go
server := rest.NewServer(config, productsHandler, userHandler)
server.Start()
```
- HTTP server à¦¤à§ˆà¦°à¦¿
- Routes register à¦•à¦°à¦¾
- Port 8000 à¦¤à§‡ listen à¦¶à§à¦°à§
- Blocking call - application runs until stopped

**à¦¡à¦¿à¦œà¦¾à¦‡à¦¨ à¦ªà§à¦¯à¦¾à¦Ÿà¦¾à¦°à§à¦¨:**
- âœ… Dependency Injection
- âœ… Constructor Injection
- âœ… Dependency Inversion Principle
- âœ… Single Responsibility (each layer has one job)

**Error Handling Strategy:**
- Critical errors â†’ os.Exit(1)
- Prevents partial initialization
- Fail-fast approach

---

### ğŸ”¹ config/config.go

```go
package config

import (
	"fmt"
	"os"
	"github.com/joho/godotenv"
)

var configuration *Config

type Config struct {
	Version      string
	ServiceName  string
	Port         string
	JwtSecureKey string
	DBConfig     DBConfig
}

func loadConfig() {
	// Load .env file
	if err := godotenv.Load(); err != nil {
		fmt.Println("Error loading .env file", err)
		os.Exit(1)
	}

	// Load VERSION
	version := os.Getenv("VERSION")
	if version == "" {
		fmt.Println("VERSION not set in environment")
		os.Exit(1)
	}

	// Load SERVICE_NAME
	serviceName := os.Getenv("SERVICE_NAME")
	if serviceName == "" {
		fmt.Println("SERVICE_NAME not set in environment")
		os.Exit(1)
	}

	// Load PORT
	port := os.Getenv("PORT")
	if port == "" {
		fmt.Println("PORT not set in environment")
		os.Exit(1)
	}

	// Validate PORT is numeric
	if _, err := fmt.Sscanf(port, "%d", new(int)); err != nil {
		fmt.Println("PORT must be a valid number")
		os.Exit(1)
	}

	// Load JWT_SECURE_KEY
	jwtSecurekey := os.Getenv("JWT_SECURE_KEY")
	if jwtSecurekey == "" {
		fmt.Println("JWT Secure Key not set in environment")
		os.Exit(1)
	}

	fmt.Printf("Configuration loaded: \nVersion=%s,\nServiceName=%s,\nPort=%s\n", 
		version, serviceName, port)

	configuration = &Config{
		Version:      version,
		ServiceName:  serviceName,
		Port:         port,
		JwtSecureKey: jwtSecurekey,
	}

	loadDBConfig()
}

func GetConfig() *Config {
	if configuration == nil {
		loadConfig()
	}
	return configuration
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Singleton Pattern Implementation:**
```go
var configuration *Config  // Package-level variable

func GetConfig() *Config {
	if configuration == nil {  // Lazy initialization
		loadConfig()
	}
	return configuration
}
```
- à¦à¦•à¦¬à¦¾à¦° à¦®à¦¾à¦¤à§à¦° load à¦¹à¦¯à¦¼
- Memory efficient
- Thread-safe à¦¨à¦¾ (simple use case à¦à¦° à¦œà¦¨à§à¦¯ OK)

**Validation Strategy:**
```go
if version == "" {
	fmt.Println("VERSION not set in environment")
	os.Exit(1)
}
```
- à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ required field check à¦•à¦°à¦¾ à¦¹à¦¯à¦¼
- Missing value = immediate exit
- Prevents runtime errors

**Port Validation:**
```go
if _, err := fmt.Sscanf(port, "%d", new(int)); err != nil {
	fmt.Println("PORT must be a valid number")
	os.Exit(1)
}
```
- Port numeric à¦•à¦¿à¦¨à¦¾ verify à¦•à¦°à¦¾
- Invalid port = application won't start
- Prevents bind errors

**Configuration Print:**
```go
fmt.Printf("Configuration loaded: \nVersion=%s,\nServiceName=%s,\nPort=%s\n", 
	version, serviceName, port)
```
- Startup time à¦ configuration à¦¦à§‡à¦–à¦¾à¦¨à§‹
- Debugging à¦à¦° à¦œà¦¨à§à¦¯ helpful
- Production à¦ sensitive data print à¦•à¦°à¦¾ à¦‰à¦šà¦¿à¦¤ à¦¨à¦¾

---

### ğŸ”¹ config/db_config.go

```go
package config

import (
	"fmt"
	"os"
)

type DBConfig struct {
	Host     string
	Port     string
	User     string
	Password string
	DBName   string
	SSLMode  string
}

func loadDBConfig() {
	dbHost := os.Getenv("DB_HOST")
	if dbHost == "" {
		fmt.Println("DB_HOST not set in environment")
		os.Exit(1)
	}

	dbPort := os.Getenv("DB_PORT")
	if dbPort == "" {
		fmt.Println("DB_PORT not set in environment")
		os.Exit(1)
	}

	dbUser := os.Getenv("DB_USER")
	if dbUser == "" {
		fmt.Println("DB_USER not set in environment")
		os.Exit(1)
	}

	dbPassword := os.Getenv("DB_PASSWORD")
	if dbPassword == "" {
		fmt.Println("DB_PASSWORD not set in environment")
		os.Exit(1)
	}

	dbName := os.Getenv("DB_NAME")
	if dbName == "" {
		fmt.Println("DB_NAME not set in environment")
		os.Exit(1)
	}

	dbSSLMode := os.Getenv("DB_SSLMODE")
	if dbSSLMode == "" {
		fmt.Println("DB_SSLMODE not set in environment")
		os.Exit(1)
	}

	configuration.DBConfig = DBConfig{
		Host:     dbHost,
		Port:     dbPort,
		User:     dbUser,
		Password: dbPassword,
		DBName:   dbName,
		SSLMode:  dbSSLMode,
	}
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Database Configuration Structure:**
```go
type DBConfig struct {
	Host     string  // Database server address (e.g., localhost, IP, domain)
	Port     string  // Database port (PostgreSQL default: 5432)
	User     string  // Database username
	Password string  // Database password
	DBName   string  // Database name to connect
	SSLMode  string  // SSL connection mode (disable, require, verify-ca, verify-full)
}
```

**SSL Mode Options:**
- `disable`: No SSL (development only)
- `require`: SSL required but don't verify
- `verify-ca`: Verify Certificate Authority
- `verify-full`: Full SSL verification (production recommended)

**Security Considerations:**
- Password plain text à¦¤à§‡ load à¦¹à¦¯à¦¼ (acceptable for config loading)
- Never log password values
- Use environment variables or secret managers
- .env file should be in .gitignore

**Configuration Validation:**
- à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ field required
- Missing any field = application exit
- Fail-fast approach prevents connection errors

---

### ğŸ”¹ domain/user.go

```go
package domain

import "time"

type User struct {
	ID        string    `json:"id" db:"id"`
	Name      string    `json:"name" db:"name"`
	Email     string    `json:"email" db:"email"`
	Password  string    `json:"-" db:"password"`
	IsOwner   bool      `json:"is_owner" db:"is_owner"`
	CreatedAt time.Time `db:"created_at"`
	UpdatedAt time.Time `db:"updated_at"`
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Struct Tags Explanation:**

**JSON Tags:**
```go
`json:"id"`      // Serialization name in JSON
`json:"-"`       // Exclude from JSON (password security)
```

**DB Tags:**
```go
`db:"id"`        // Column name in database
`db:"password"`  // Maps to password column
```

**Field-by-Field Analysis:**

1. **ID (UUID)**
   - Type: string (UUID stored as string)
   - Database: UUID type
   - JSON: "id"
   - Purpose: Unique identifier

2. **Name**
   - Type: string
   - Max length: 150 chars (DB constraint)
   - Required: Yes
   - Purpose: User's full name

3. **Email**
   - Type: string
   - Max length: 255 chars
   - Unique: Yes (DB constraint)
   - Required: Yes
   - Purpose: Login credential & contact

4. **Password**
   - Type: string
   - JSON: `-` (excluded from JSON responses)
   - Hashed: MD5 (âš ï¸ should use bcrypt)
   - Purpose: Authentication

5. **IsOwner**
   - Type: bool
   - Default: false
   - Purpose: Role-based access control
   - Future: Can determine admin privileges

6. **CreatedAt**
   - Type: time.Time
   - Auto-set: Database default NOW()
   - Not in JSON: Can be added if needed
   - Purpose: Audit trail

7. **UpdatedAt**
   - Type: time.Time
   - Auto-updated: ON UPDATE NOW()
   - Not in JSON: Can be added if needed
   - Purpose: Audit trail

**Design Patterns:**
- âœ… Domain-Driven Design (DDD)
- âœ… Rich Domain Model
- âœ… Separation of Concerns (domain logic separate)

**Security:**
- Password excluded from JSON with `json:"-"`
- Never exposed in API responses
- Hashed before storage

---

### ğŸ”¹ domain/product.go

```go
package domain

type Product struct {
	ID          string  `json:"id" db:"id"`
	Title       string  `json:"title" db:"title"`
	Description string  `json:"description" db:"description"`
	Price       float64 `json:"price" db:"price"`
	ImageURL    string  `json:"image_url" db:"image_url"`
	CreatedAt   string  `json:"created_at" db:"created_at"`
	UpdatedAt   string  `json:"updated_at" db:"updated_at"`
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Field-by-Field Analysis:**

1. **ID (UUID)**
   - Type: string
   - Generated: Database (uuid_generate_v4())
   - Immutable: Never changes
   - Purpose: Unique product identifier

2. **Title**
   - Type: string
   - Max length: 255 chars
   - Required: Yes
   - Example: "iPhone 15 Pro Max"
   - Purpose: Product name

3. **Description**
   - Type: string
   - Max length: Unlimited (TEXT type)
   - Optional: Can be null
   - Example: "Latest flagship smartphone..."
   - Purpose: Detailed product information

4. **Price**
   - Type: float64
   - Database: NUMERIC(10, 2)
   - Format: 10 digits total, 2 decimal places
   - Example: 999.99
   - Purpose: Product price in currency

5. **ImageURL**
   - Type: string
   - Format: URL string
   - Optional: Can be null
   - Example: "https://cdn.example.com/product.jpg"
   - Purpose: Product image reference

6. **CreatedAt**
   - Type: string (âš ï¸ should be time.Time)
   - Auto-generated: Database
   - Format: ISO 8601 timestamp
   - Purpose: Track when product was added

7. **UpdatedAt**
   - Type: string (âš ï¸ should be time.Time)
   - Auto-updated: Database
   - Format: ISO 8601 timestamp
   - Purpose: Track last modification

**Type Inconsistencies:**
```go
// Current (Product)
CreatedAt string
UpdatedAt string

// Better Practice (User)
CreatedAt time.Time
UpdatedAt time.Time
```
- User struct correctly uses time.Time
- Product should also use time.Time
- String conversion should happen at JSON layer

**Price Handling:**
- float64 suitable for display
- For financial calculations, consider decimal library
- Prevents floating-point precision issues

---

### ğŸ”¹ infra/db/connection.go

```go
package db

import (
	"ecom_project/config"
	"fmt"
	"github.com/jmoiron/sqlx"
	_ "github.com/lib/pq"
)

func GetDBConnectionString(config *config.DBConfig) string {
	connectionString := fmt.Sprintf(
		"user=%s password=%s host=%s port=%s dbname=%s sslmode=%s",
		config.User, 
		config.Password, 
		config.Host, 
		config.Port, 
		config.DBName, 
		config.SSLMode,
	)
	return connectionString
}

func NewDBConnection(config config.DBConfig) (*sqlx.DB, error) {
	dbSource := GetDBConnectionString(&config)
	
	db, err := sqlx.Connect("postgres", dbSource)
	if err != nil {
		fmt.Println(err)
		return nil, err
	}
	
	return db, nil
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Connection String Format:**
```
user=postgres password=2003 host=127.0.0.1 port=5432 dbname=ecom sslmode=disable
```

**GetDBConnectionString() Analysis:**
- **Purpose:** Config à¦¥à§‡à¦•à§‡ connection string à¦¤à§ˆà¦°à¦¿
- **Format:** PostgreSQL standard connection string
- **Security:** Password plain text (connection string à¦ normal)

**NewDBConnection() Analysis:**

1. **Connection String Creation:**
```go
dbSource := GetDBConnectionString(&config)
```
- Config struct à¦¥à§‡à¦•à§‡ formatted string à¦¤à§ˆà¦°à¦¿

2. **Database Connection:**
```go
db, err := sqlx.Connect("postgres", dbSource)
```
- `sqlx.Connect()` - Connection pool à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§‡
- `"postgres"` - Driver name (lib/pq)
- `dbSource` - Connection configuration

3. **Error Handling:**
```go
if err != nil {
	fmt.Println(err)
	return nil, err
}
```
- Connection failure print à¦•à¦°à¦¾
- Error propagate à¦•à¦°à¦¾ caller à¦

**sqlx Library Benefits:**
- Named parameters support (`:name` syntax)
- Struct scanning
- Better error messages
- Connection pooling
- Compatible with database/sql

**Connection Pooling:**
- sqlx automatically creates connection pool
- Default settings used
- Can be configured with db.SetMaxOpenConns(), db.SetMaxIdleConns()

**Driver Import:**
```go
_ "github.com/lib/pq"
```
- Blank import
- Registers PostgreSQL driver
- Side-effect only (no direct usage)

---

### ğŸ”¹ infra/db/migrate.go

```go
package db

import (
	"fmt"
	"github.com/jmoiron/sqlx"
	migrate "github.com/rubenv/sql-migrate"
)

func MigrateDB(db *sqlx.DB, dir string) error {
	migratements := &migrate.FileMigrationSource{
		Dir: dir,
	}
	
	_, err := migrate.Exec(db.DB, "postgres", migratements, migrate.Up)
	if err != nil {
		return err
	}
	
	fmt.Println("Database migration completed successfully")
	return nil
}
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Migration System:**

1. **File-Based Migrations:**
```go
migratements := &migrate.FileMigrationSource{
	Dir: dir,  // "./migrations"
}
```
- SQL files à¦¥à§‡à¦•à§‡ migrations load à¦•à¦°à§‡
- Directory structure based
- Version-ordered execution

2. **Migration Execution:**
```go
_, err := migrate.Exec(db.DB, "postgres", migratements, migrate.Up)
```
- `db.DB` - Underlying *sql.DB (from sqlx)
- `"postgres"` - Database dialect
- `migratements` - Migration source
- `migrate.Up` - Direction (up = apply, down = rollback)

**Migration File Naming Convention:**
```
000001-create-users.up.sql      # Up migration
000001-create-users.down.sql    # Down migration (rollback)
000002-create-products.up.sql
000002-create-products.down.sql
```

**Version Tracking:**
- Migration library tracks applied versions
- Creates `gorp_migrations` table
- Prevents duplicate execution
- Idempotent by design

**Migration Flow:**
1. Read all `.up.sql` files from directory
2. Check which versions already applied
3. Execute pending migrations in order
4. Update version tracking table
5. Return success/error

**Error Handling:**
- Migration failure stops execution
- Partial migrations rolled back
- Error propagated to caller
- Application exits on failure (in serve.go)

**Best Practices:**
- Use sequential numbering (000001, 000002, ...)
- Write reversible migrations (both up and down)
- Test migrations in development first
- Keep migrations small and focused

---

### ğŸ”¹ migrations/ SQL Files

#### 000001-create-users.up.sql

```sql
-- +migrate Up

CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE IF NOT EXISTS users (
     id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
     name VARCHAR(150) NOT NULL,
     email VARCHAR(255) UNIQUE NOT NULL,
     password TEXT NOT NULL,
     is_owner BOOLEAN NOT NULL DEFAULT FALSE,
     created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
     updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Migration Directive:**
```sql
-- +migrate Up
```
- Migration library à¦à¦° special comment
- Marks file as "up" migration
- Tells migrate tool to execute this on upgrade

**UUID Extension:**
```sql
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
```
- PostgreSQL UUID functions enable à¦•à¦°à§‡
- `uuid_generate_v4()` function available à¦•à¦°à§‡
- Idempotent (`IF NOT EXISTS`)

**Table Creation - Users:**

**Primary Key:**
```sql
id UUID PRIMARY KEY DEFAULT uuid_generate_v4()
```
- UUID type (128-bit unique identifier)
- Auto-generated (no need to provide on INSERT)
- Better than SERIAL for distributed systems

**Name Field:**
```sql
name VARCHAR(150) NOT NULL
```
- Variable character field (max 150)
- Required field
- Stores user's full name

**Email Field:**
```sql
email VARCHAR(255) UNIQUE NOT NULL
```
- Max 255 characters
- UNIQUE constraint (index automatically created)
- Required field
- Used for login

**Password Field:**
```sql
password TEXT NOT NULL
```
- Unlimited length (TEXT type)
- Stores hashed password (MD5 in this case)
- Required field

**IsOwner Field:**
```sql
is_owner BOOLEAN NOT NULL DEFAULT FALSE
```
- Boolean type (true/false)
- Default: false (regular user)
- Role-based access control

**Timestamps:**
```sql
created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
```
- TIMESTAMPTZ = Timestamp with timezone
- Auto-populated on INSERT
- Audit trail

---

#### 000001-create-users.down.sql

```sql
-- +migrate Down
DROP TABLE IF EXISTS users;
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Rollback Migration:**
- Reverses changes made by up migration
- Safe with `IF EXISTS`
- Deletes table and all data

**When Used:**
- Migration rollback
- Development testing
- Fixing migration errors

---

#### 000002-create-products.up.sql

```sql
-- +migrate Up

CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE IF NOT EXISTS products (
     id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    title VARCHAR(255) NOT NULL,
    description TEXT,
    price NUMERIC(10, 2) NOT NULL DEFAULT 0,
    image_url TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤:**

**Products Table Structure:**

**Title Field:**
```sql
title VARCHAR(255) NOT NULL
```
- Product name
- Max 255 characters
- Required

**Description Field:**
```sql
description TEXT
```
- Optional field (can be NULL)
- Unlimited length
- Detailed product information

**Price Field:**
```sql
price NUMERIC(10, 2) NOT NULL DEFAULT 0
```
- NUMERIC type (exact decimal)
- Total 10 digits, 2 after decimal
- Example: 12345678.90
- Default: 0
- Better than FLOAT for money

**Image URL Field:**
```sql
image_url TEXT
```
- Optional field
- Stores URL string
- Reference to image file

**Timestamps:**
```sql
created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
```
- Same as users table
- Audit trail

---

## ğŸ” à¦¸à¦¿à¦•à¦¿à¦‰à¦°à¦¿à¦Ÿà¦¿ à¦«à¦¿à¦šà¦¾à¦°à§à¦¸

### 1. JWT Authentication

**Implementation Location:** `rest/middleware/authenticate_jwt.go`

**Token Structure:**
```
Header.Payload.Signature
```

**Header:**
```json
{
    "alg": "HS256",
    "typ": "JWT"
}
```

**Payload:**
```json
{
    "sub": "user_id",
    "name": "User Name",
    "email": "user@example.com",
    "is_owner": false,
    "created_at": "2026-02-10T10:00:00Z",
    "updated_at": "2026-02-10T10:00:00Z"
}
```

**Signature Generation:**
```go
message := base64(header) + "." + base64(payload)
signature := HMAC-SHA256(message, JWT_SECURE_KEY)
token := message + "." + base64(signature)
```

**Verification Process:**
1. Extract token from Authorization header
2. Split into parts (header, payload, signature)
3. Recreate signature using secret key
4. Compare signatures
5. Allow/deny request

**Protected Endpoints:**
- POST /products
- PUT /products/{id}
- DELETE /products/{id}

---

### 2. Password Hashing

**Implementation:** `util/secPass.go`

```go
func SecPass(pass string) string {
	hash := md5.Sum([]byte(pass))
	return hex.EncodeToString(hash[:])
}
```

**âš ï¸ Security Warning:**
- MD5 à¦¹à§à¦¯à¦¾à¦¶à¦¿à¦‚ deprecated à¦à¦¬à¦‚ à¦¦à§à¦°à§à¦¬à¦²
- Rainbow table attacks à¦à¦° à¦¶à¦¿à¦•à¦¾à¦° à¦¹à¦¤à§‡ à¦ªà¦¾à¦°à§‡
- Recommended: bcrypt, argon2, scrypt

**Better Implementation (Recommendation):**
```go
import "golang.org/x/crypto/bcrypt"

func HashPassword(password string) (string, error) {
	bytes, err := bcrypt.GenerateFromPassword([]byte(password), 14)
	return string(bytes), err
}

func CheckPassword(password, hash string) bool {
	err := bcrypt.CompareHashAndPassword([]byte(hash), []byte(password))
	return err == nil
}
```

---

### 3. Rate Limiting

**Implementation:** `rest/middleware/rate_limit.go`

**Configuration:**
```go
const (
	maxReqPerSec   = 6              // Maximum requests per second
	blockDuration  = 5 * time.Minute // Block duration
	windowDuration = 1 * time.Second // Time window
)
```

**Algorithm:**

```
For each incoming request:
  1. Get client IP
  2. Check if IP is blocked
     â†’ If blocked and block time not expired: Reject (429)
  3. Check request count in current time window
     â†’ If window expired: Reset counter
  4. Increment request counter
  5. If counter > maxReqPerSec:
     â†’ Block IP for blockDuration
     â†’ Reject request (429)
  6. Otherwise: Allow request
```

**Data Structure:**
```go
type clientInfo struct {
	requests int       // Request count in current window
	window   time.Time // Window start time
	blocked  time.Time // Block end time
}

var reqData = make(map[string]*clientInfo)
```

**IP Extraction:**
```go
func getIP(r *http.Request) string {
	ip, _, err := net.SplitHostPort(r.RemoteAddr)
	if err != nil {
		return r.RemoteAddr
	}
	return ip
}
```

**Concurrency Safety:**
```go
var mu sync.Mutex  // Protects reqData map

mu.Lock()
// ... access reqData ...
mu.Unlock()
```

**Response:**
```
HTTP/1.1 429 Too Many Requests
Content-Type: text/plain

Too many requests! IP blocked for 5 minutes.
```

---

### 4. CORS (Cross-Origin Resource Sharing)

**Implementation:** `rest/middleware/cors.go`

```go
func CORS(next http.Handler) http.Handler {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		w.Header().Set("Content-Type", "application/json")
		w.Header().Set("Access-Control-Allow-Origin", "*")
		w.Header().Set("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE, PATCH, OPTIONS")
		w.Header().Set("Access-Control-Allow-Headers", "Content-Type")

		next.ServeHTTP(w, r)
	})
}
```

**Headers Explanation:**

**Content-Type:**
```
Content-Type: application/json
```
- à¦¸à¦¬ response JSON format à¦

**Allow-Origin:**
```
Access-Control-Allow-Origin: *
```
- à¦¯à§‡à¦•à§‹à¦¨à§‹ domain à¦¥à§‡à¦•à§‡ request allow
- Production à¦ specific domains à¦¦à§‡à¦“à¦¯à¦¼à¦¾ à¦‰à¦šà¦¿à¦¤
- Example: `Access-Control-Allow-Origin: https://myapp.com`

**Allow-Methods:**
```
Access-Control-Allow-Methods: GET, POST, PUT, DELETE, PATCH, OPTIONS
```
- Allowed HTTP methods
- REST operations support

**Allow-Headers:**
```
Access-Control-Allow-Headers: Content-Type
```
- Client à¦•à§‹à¦¨ headers à¦ªà¦¾à¦ à¦¾à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡
- Should include: Authorization (for JWT)

**Preflight Requests:**
```go
func Preflight(next http.Handler) http.Handler {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		if r.Method == http.MethodOPTIONS {
			w.WriteHeader(http.StatusOK)
			return
		}
		next.ServeHTTP(w, r)
	})
}
```
- OPTIONS requests handle à¦•à¦°à§‡
- Browser CORS preflight check à¦à¦° à¦œà¦¨à§à¦¯

---

### 5. Request Logging

**Implementation:** `rest/middleware/logger.go`

```go
func Logger(next http.Handler) http.Handler {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		start := time.Now()

		ip := r.Header.Get("X-Forwarded-For")
		if ip == "" {
			ip = r.RemoteAddr
		}

		next.ServeHTTP(w, r)

		fmt.Printf(
			"User IP: %s | Method: %s | URL: %s | Duration: %v\n",
			ip,
			r.Method,
			r.URL.Path,
			time.Since(start),
		)
	})
}
```

**Log Format:**
```
User IP: 192.168.1.100 | Method: GET | URL: /products | Duration: 15ms
User IP: 127.0.0.1 | Method: POST | URL: /users/login | Duration: 234ms
```

**IP Detection:**
1. Check `X-Forwarded-For` header (proxy/load balancer)
2. Fallback to `RemoteAddr` (direct connection)

**Metrics Collected:**
- Client IP address
- HTTP method
- Request path
- Response time (duration)

**Use Cases:**
- Performance monitoring
- Debugging
- Security auditing
- Traffic analysis

---

## ğŸ”„ à¦®à¦¿à¦¡à¦²à¦“à¦¯à¦¼à§à¦¯à¦¾à¦° à¦¸à¦¿à¦¸à§à¦Ÿà§‡à¦®

### Middleware Chain Architecture

```
HTTP Request
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CORS          â”‚ â† Set CORS headers
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Preflight     â”‚ â† Handle OPTIONS requests
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Logger        â”‚ â† Log request details
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RateLimit     â”‚ â† Check rate limits
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AuthenticateJWT â”‚ â† Verify JWT (conditional)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Handler       â”‚ â† Execute business logic
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   HTTP Response
```

### Middleware Manager

**Implementation:** `rest/middleware/manager.go`

```go
type Middleware func(http.Handler) http.Handler

type Manager struct {
	middlewares []Middleware
}

func NewManager() *Manager {
	return &Manager{
		middlewares: []Middleware{},
	}
}

func (m *Manager) Use(mw Middleware) {
	m.middlewares = append(m.middlewares, mw)
}

func (m *Manager) Apply(handler http.Handler, middleware ...Middleware) http.Handler {
	h := handler
	for i := len(middleware) - 1; i >= 0; i-- {
